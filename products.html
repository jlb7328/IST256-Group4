<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products</title>
    <link rel="stylesheet" href="styles.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css"/>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
  </head>
<body>
    <header>
        <h1>Products</h1>
        <p>Created by Group 4</p>
    </header>
    <nav aria-label="Main Navigation">
        <ul>
            <li><a href="index.html" class="tooltip" data-tooltip="Go to the home page">Home</a></li>
            <li><a href="products.html" class="tooltip" data-tooltip="Browse our products">Products</a></li>
            <li><a href="shopping_cart.html" class="tooltip" data-tooltip="View your shopping cart">Shopping Cart</a></li>
            <li><a href="about_us.html" class="tooltip" data-tooltip="Learn more about us">About Us</a></li>
            <li><a href="contact.html" class="tooltip" data-tooltip="Get in touch with us">Contact</a></li>
            <li><a href="sign_up.html" class="tooltip signup-btn" data-tooltip="Create an account">Sign Up</a></li>
        </ul>
    </nav>
    <main>
        <section>
        <h2>Our Products</h2>
        <p>Explore our wide range of products below.</p>

        <!-- Search bar -->
        <label for="search-product">Search Products:</label>
        <input id="search-product" type="text" placeholder="Search products..."/>
        <div id="search-result" class="mt-3"></div>

        <ul id="product-list"></ul>

        </section>
    </main>
    <footer>
        <p>&copy; 2025 Group 4. All Rights Reserved.</p>
    </footer>
        <script>
            let productData = [];

            function renderProductList(products) {
                $("#product-list").empty();
                products.forEach(product => {
                    $("#product-list").append(`
                        <div class="product-item">
                            <h3>${product.ProductDescription}</h3>
                            <p><strong>Category:</strong> ${product.ProductCategory}</p>
                            <p><strong>Unit:</strong> ${product.ProductUnitOfMeasure}</p>
                            <p><strong>Weight:</strong> ${product.ProductWeight}</p>
                            <p><strong>Price:</strong> $${product.ProductPrice.toFixed(2)}</p>
                            <p>${product.ProductImage ? `<img src="${product.ProductImage}" alt="${product.ProductDescription}" style="max-width:150px;">` : ""}<p>
                            <br>
                            <button class="add-to-cart" data-id="${product.ProductId}">Add to Cart</button>
                            <hr>
                            </div>
                    `);
                });
            }

            function addToCart(productId) {
                let cart = JSON.parse(sessionStorage.getItem("cart")) || [];
                const existing = cart.find(item => item.ProductId === productId);

                if (existing) {
                    existing.Quantity += 1;
                } else {
                    cart.push({ ProductId: productId, Quantity: 1 });
                }

                sessionStorage.setItem("cart", JSON.stringify(cart));
                alert("Item added to cart!");
            }

            $(document).ready(function () {
                $.getJSON("products.json", function (data) {
                    productData = data;
                    renderProductList(productData);

                    const productNames = data.map(p => p.ProductDescription);
                    $("#search-product").autocomplete({
                        source: productNames,
                        select: function (event, ui) {
                            const selected = data.find(p => p.ProductDescription === ui.item.value);
                            if (selected) {
                            $("#search-result").html(`
                                    <div>
                                        <h3>${selected.ProductDescription}</h3>
                                        <p><strong>Category:</strong> ${selected.ProductCategory}</p>
                                        <p><strong>Unit:</strong> ${selected.ProductUnitOfMeasure}</p>
                                        <p><strong>Weight:</strong> ${selected.ProductWeight}</p>
                                        <p><strong>Price:</strong> $${selected.ProductPrice.toFixed(2)}</p>
                                        <button class="add-to-cart" data-id="${selected.ProductId}">Add to Cart</button>
                                    </div>
                                `);
                                $("html, body").animate({
                                    scrollTop: $("#search-result").offset().top
                                }, 500);
                            }
                        }
                    });
                });

                $(document).on("click", ".add-to-cart", function () {
                    const productId = $(this).data("id");
                    addToCart(productId);
                });
            });
    </script>
</body>
</html>
